3.1 IPv6数据包处理模块
3.1.1 收发环境的初始化
功能项	详细说明
功能描述	该模块的功能是完成收发环境的初始化。
优先级	高
输入	目标MAC地址、目标IPv6地址、默认网关IPv6地址、IPv6 地址的网络前缀长度
用户操作	用户无需操作。
系统操作	1.	系统通过命令获取并确认本地接口名称、本地IPv6地址。
2.	通过命令检查目标的IPv6 地址的连通性。
3.	通过命令绑定目标 IPv6 地址和 MAC 地址。
4.	通过命令配置并验证静态路由。
5.	通过命令验证NDP绑定。
输出	静态 NDP 路由绑定成功的确认信息、路由表更新信息
3.1.2 IPv6数据包的构造
功能项	详细说明
功能描述	该模块的功能是根据IPv6数据包的格式进行数据包的构造。
优先级	高
输入	目的MAC地址、目的IPv6地址、扩展头内容、负载内容
用户操作	用户无需操作
系统操作	1.	根据扩展头内容和负载内容的长度计算分片。
2.	系统通过命令自动获取本机的MAC地址和IPv6地址。
3.	根据以太网数据帧结构、IPv6数据包结构构造数据包，如果扩展头内容或负载内容过长需要进行分片。同时在数据包的扩展头部分添加本系统的特殊字段。
输出	构造好的IPv6数据包
3.1.3 IPv6发送流表的维护
功能项	详细说明
功能描述	该模块的功能是维护一个发送流表来跟踪每个数据包的状态（是否发送、是否确认），以实现数据包的可靠传输机制。
优先级	高
输入	滑动窗口大小、总数据包数量、数据包状态信息（已发送但未确认、已确认、待发送）、超时时间
用户操作	用户无需操作
系统操作	1.	初始化滑动窗口大小、窗口位置和下一个要发送的数据包序号。
2.	维护流表状态。流表中记录每个数据包的发送状态（包括：已发送但未确认、已确认、待发送）和发送窗口的大小。
3.	当接收到ACK时，更新滑动窗口，将窗口基序号移动到下一个未确认的数据包，释放窗口位置；如果ACK确认的序号超出了滑动窗口的范围，则忽略该ACK。
4.	如果超过一定时间没有收到ACK，则标记该数据包为超时，并在下次重传该数据包，重传后，重新启动计时器。
5.	根据ACK和超时情况，更新流表中的数据包状态。
输出	滑动窗口位置、待发送数据包序号、流表更新
3.1.4 IPv6数据包的发送
功能项	详细说明
功能描述	该模块的功能是发送IPv6数据包。
优先级	高
输入	待发送的IPv6数据包、滑动窗口位置和大小、目标IPv6地址、目标MAC地址
用户操作	用户无需操作
系统操作	1.	检查滑动窗口大小，确保下一个要发送的数据包序号在窗口范围内。
2.	根据当前序号从流表中找到对应的数据包，并将其发送出去。
3.	发送成功后，更新流表中该数据包的状态为“已发送但未确认”。
4.	在发送数据包后进入等待状态，监听ACK包，接收到ACK后，检查该ACK是否确认了当前窗口中的某个数据包，并相应地更新流表。
5.	如果检测到某个数据包超时，则自动重新发送该数据包，并重新启动计时器。
6.	当所有数据包都收到ACK确认，且窗口基序号等于数据包数量时，传输完成，关闭传输链接。
输出	发送是否成功的结果
3.1.5 IPv6数据包的接收
功能项	详细说明
功能描述	该模块的功能是进行IPv6数据包的接收。
优先级	高
输入	无
用户操作	用户无需操作
系统操作	1.	系统初始化必要的接收参数，包括：四元组（源IP、目的IP、目的MAC地址、拓展头前16字节）、滑动窗口大小、允许接收的最大队列长度。
2.	启动网络接口用于接收 IPv6 数据包。
3.	接收到数据包后，首先检查扩展头部分，判断是否包含本系统的特殊字段，如果不包含则丢弃。
4.	从数据包的 IP 和端口信息提取四元组。如果该数据包来自一个新的会话，系统为其创建一个新的会话管理实例，并为该会话创建独立线程用于处理接收任务。
5.	为每个会话创建线程来接收和处理数据包，确保多会话处理时互不干扰。
输出	接收到的的IPv6数据包
3.1.6 IPv6接收流表的维护
功能项	详细说明
功能描述	该模块的功能是维护一个接收流表来跟踪每个数据包的状态（是否确认），以实现数据包的可靠传输机制。
优先级	高
输入	滑动窗口大小、四元组会话信息、数据包序列号、数据包状态信息（是否已确认）、接收缓冲区
用户操作	用户无需操作
系统操作	1.	每个接收到的数据包都包含序列号，根据滑动窗口的当前位置判断该数据包是否在窗口范围内。
2.	如果接收到的包是正确的序列号，则更新滑动窗口，释放窗口位置并允许接收下一个数据包。
3.	如果接收到有效的数据包，则发送 ACK 确认，通知发送方可以发送下一个数据包。
4.	对于乱序数据包，则将其缓存，等待接收到正确的包后移动窗口并处理缓存数据。
5.	当一个会话传输完成后，清理会话的缓存和滑动窗口，释放资源并结束会话。
输出	无
3.1.7 IPv6数据包的解析
功能项	详细说明
功能描述	该模块的功能是进行IPv6数据包的解析。
优先级	高
输入	从滑动窗口接收到的数据包
用户操作	用户无需操作
系统操作	1.	判断数据包信息，如果没有负载部分，则重组扩展头部分。
2.	如果有负载部分，则重组负载部分的信息。
输出	重组好的扩展头内容与负载内容


