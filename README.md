# IPv6 协议栈实现

## 项目概述

本项目实现了一个简单的IPv6协议栈，包含数据包的构造、发送和接收功能。项目主要包括以下模块：

1. **IPv6Packet**: 负责构造带有IPv6目的选项报头的IPv6数据包。
2. **Sender**: 继承自IPv6Packet，负责发送数据包并维护发送流表。
3. **Receiver**: 继承自IPv6Packet，负责接收数据包并维护接收流表。

## 模块功能

### 1. IPv6Packet

- **功能描述**: 根据IPv6数据包的格式进行数据包的构造。
- **输入**: 目的MAC地址、目的IPv6地址、扩展头内容、负载内容。
- **输出**: 构造好的IPv6数据包。
- **系统操作**:
  1. 根据扩展头内容和负载内容的长度计算分片。
  2. 系统通过命令自动获取本机的MAC地址和IPv6地址。
  3. 根据以太网数据帧结构、IPv6数据包结构构造数据包，如果扩展头内容或负载内容过长需要进行分片。同时在数据包的扩展头部分添加本系统的特殊字段。

### 2. Sender

- **功能描述**: 发送IPv6数据包，并维护一个发送流表来跟踪每个数据包的状态（是否发送、是否确认），以实现数据包的可靠传输机制。
- **输入**: 待发送的IPv6数据包、滑动窗口位置和大小、目标IPv6地址、目标MAC地址。
- **输出**: 发送是否成功的结果。
- **系统操作**:
  1. 初始化滑动窗口大小、窗口位置和下一个要发送的数据包序号。
  2. 维护流表状态，记录每个数据包的发送状态。
  3. 处理ACK确认和超时重传逻辑。

### 3. Receiver

- **功能描述**: 接收IPv6数据包，并维护一个接收流表来跟踪每个数据包的状态（是否确认），以实现数据包的可靠传输机制。
- **输入**: 无。
- **输出**: 接收到的IPv6数据包。
- **系统操作**:
  1. 初始化接收参数，包括四元组、滑动窗口大小等。
  2. 启动网络接口用于接收IPv6数据包。
  3. 处理接收到的数据包，更新流表状态。

## 文件结构

- `IPv6Packet.h` / `IPv6Packet.cpp`: 定义和实现IPv6数据包的构造。
- `Sender.h` / `Sender.cpp`: 定义和实现数据包的发送及发送流表的维护。
- `Receiver.h` / `Receiver.cpp`: 定义和实现数据包的接收及接收流表的维护。

## 使用说明

1. **构造数据包**: 使用`IPv6Packet`类构造IPv6数据包。
2. **发送数据包**: 使用`Sender`类发送数据包，并自动维护发送流表。
3. **接收数据包**: 使用`Receiver`类接收数据包，并自动维护接收流表。

## 运行环境

- C++编译器（支持C++11及以上）
- CMake（可选，用于构建项目）

## 编译与运行

1. 使用CMake构建项目：
   ```bash
   mkdir build
   cd build
   cmake ..
   make
   ```

2. 运行可执行文件：
   ```bash
   ./your_executable_name
   ```

## 未来改进

- 支持更多的IPv6扩展头选项。
- 增强错误处理和日志记录。
- 实现更复杂的流表管理策略。

## 附加功能

### 收发环境的初始化

- **功能描述**: 完成收发环境的初始化。
- **系统操作**:
  1. 获取并确认本地接口名称、本地IPv6地址。
  2. 检查目标的IPv6地址的连通性。
  3. 绑定目标IPv6地址和MAC地址。
  4. 配置并验证静态路由。
  5. 验证NDP绑定。

### IPv6数据包的解析

- **功能描述**: 进行IPv6数据包的解析。
- **系统操作**:
  1. 判断数据包信息，如果没有负载部分，则重组扩展头部分。
  2. 如果有负载部分，则重组负载部分的信息。
